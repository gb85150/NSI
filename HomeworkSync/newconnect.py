import getpass as gp
from unittest import result
import requests
import json


class Api:
    """
    Classe d'interaction avec l'API de Ecoledirecte
    Les fonctions sont les suivantes :
    - gettoken() : Récupère le token d'authentification
    - getinfos() : Récupère les informations de l'utilisateur
    - getcours() : Récupère les cours de l'utilisateur
    - getnotes() : Récupère les notes de l'utilisateur
    - getabsences() : Récupère les absences de l'utilisateur
    - __init__() : Constructeur de la classe
    """

    def __init__(self, password=False, mail=False, url=None, token=None):
        """

        """
        self.__password = password
        self.__mail = mail
        self.__url = url
        self.__token = token
        print("Launching... Please wait !")
        if self.__password or self.__mail:
            self.__mail = input("Email ? :")
            self.__password = gp.getpass(prompt="Password ? :")
            print("Ready")

    def gettoken(self):
        url = "https://api.ecoledirecte.com/v3/login.awp"
        headers = {}
        payload = "data={\n\t\"identifiant\": \"" + self.__mail + "\",\n\t\"motdepasse\": \"" + self.__password + "\"\n}"
        result = requests.request("POST", url, headers, data=payload)
        print(result.status_code)
        return json.load(result)
    
    def getinfos(self):
        url = "https://api.ecoledirecte.com/v3/login.awp"
        headers = {}
        payload = "data={\n\t\"identifiant\": \"" + self.__mail + "\",\n\t\"motdepasse\": \"" + self.__password + "\"\n}"
        result = requests.request("POST", url, headers, data=payload)
        print("Etat de la requête : {}".format(result.status_code))
        return json.load(result.raw)

def newaccount(db: list):
    swap = Api()
    print(swap)
    db.append(swap)
    print(db[0].)


DB = []
newaccount(DB)

"""
4e555a314d6e4a575645317265576b356247493453545635546b6c56596e5a61557a465261554a576348704861306c6b516d4630626c4d7a5a30777a65584a76616e646b5657457853564e4f6469746b0d0a5a314172576b4a4a4d55744c5330396e626b4a70547974464e31414e436e5a726569743062324a6a596e413159324e755230314e63484645626b56484d6a4a6d57444a47616c687259334647576a51780d0a4e4870706454464d63486472523164694e546448526b4661524738724e544e79623364565232703061335645516c597a626e52695755463244516f72645539754e565a6e5a7a426f566b4e615a32644d0d0a5a6e56684f554e6a4e453533633364715930783253564230527a4e4f4e57646b4d32353161555a514e485a74656c684e4e55706a4b3031614d4739734e4841776347466f5555394961315a58557a59720d0a5379746d6267304b63544530526e5a765a31705451554e345a4574436233424b4e465976546d784a4e464a4562315a55536b747854485a5761327376546e5172535738305644685764693942655535430d0a564864725932737664554a6e647a5a53556b5a305657646e55454a696431645a5630344e436c4a5963327831555652474e6a6c45526a4244595545354e44564c646c453563465252524670705a5577770d0a56336c3651556c525157387263564a445358646f4e485a484d6b743653464a5262556376515442465930464c4d7a5a364e57673159315672636d5661516d4e5844517070555552545530566c625535520d0a553039794e464a6155305269616b5651656e706b5957553563445a495633425155306854574752755a6c684462455a34546e5a4d64325a77576a645854304a6a656b4a4652454e724d7a6c61576d56470d0a61315659546b46534e456c526277304b56456734624549725a477877617a566153573153643359334b3039305656646f636d314552555269636e683256554648536d4e56556c647653465979633052760d0a6233646a5a334a59564752695330347851304652656d35304e454650546e527854306c5765444a4755324d4e436c424e554755726158497856433877643342426333527a6130355352303535575859350d0a62334e344e3038775232343459574e304d5670594c30467062574a734d6c525452576847656c643053544a52626a6c36646b4d35566c5a475433557661575268556c523654537454445170566133464b0d0a4e6e41724f4735344b3252315433637753334e30566d396b563249724f5446474b7a5a53616d46334e545a4f54445231556d465a51336c7852484d3164307876516a6c30536e686b525456615746426c0d0a53445a755a305650656d52505a6a6855536c527a6477304b536d64326155524365453033646d52306233684a55585a57576a4a4e626b5276636d4d324d325230615756735133564552533951634531750d0a55576c6153797442636b49354e545a614e564d33636d3554576a68746555564d5a454a4d63304e35656a6850563034724f43734e436d706d62324634616c4e43566a5a365357395a54466444546a4a460d0a54476b316130566b596a5a73576b4a555248526e5930746b5a58644363557452656a42365457647a56485178624374485a46684857466c70646a5648574656535645746b5a486c7362457053637a55330d0a445170615748646156327435646e6c34576d7830554455304b334a31626e6776596a68495a465a575a326732636b31336145733364557861627a4e4e4d306c6e54474645556e4a4f636d687153556c590d0a65546c465a476c445a564a785448525464584a52624574335a6b52725367304b574670774f46524d5a565a7862306b324d3046325745517959554933545445344d56686d616d6872617974484e564a710d0a55573968556a64535930744853453552646b56445346563564446c5a5747467a56586333536b316a516b525a4d5468565647356a646b356d616e674e436c4a6c4b334268615441794e46524c4d6d706c0d0a546c4a465a47307753314e6d4f4556364e45597a55555652566e4a504e47317654566c6161533968575664464f4546766456464f4e474a4f557a5a614e564e32615374684d6d686855334259533355350d0a576e68744d466b3344517052633268555657466c526e4e6c4e457050523146515432746d57584e52646d6c6f5544565361304d30636b686b5345644f62464e4b5a316f325a77
"""